# ============================================
# sshMON Configuration
# ============================================
# Copy this file to .env and configure your settings

# ============================================
# Server Settings
# ============================================

# Port to listen on (use 22 for production, 2222 for dev/testing)
PORT=2222

# Fake hostname shown in prompt (customize based on target profile)
HOSTNAME=raspberrypi

# Default username shown in prompt
USERNAME=root

# Prompt format (shown to attacker)
PROMPT_FORMAT=@${HOSTNAME}:~#

# ============================================
# Logging Configuration
# ============================================

# Path where logs are stored
LOG_PATH=./logs

# Logging level: error, warn, info, debug
LOG_LEVEL=info

# Log formats to enable (comma-separated): json,csv,session
LOG_FORMATS=json,csv,session

# JSON log filename
LOG_FILE_JSON=honeypot.jsonl

# CSV log filename
LOG_FILE_CSV=credentials.csv

# Session log directory
LOG_DIR_SESSIONS=sessions

# ============================================
# Threat Intelligence APIs
# ============================================

# Master switch for threat intelligence features
ENABLE_THREAT_INTEL=true

# --------------------------------------------
# AbuseIPDB (Recommended - Free 1000/day)
# --------------------------------------------
# Get your key: https://www.abuseipdb.com/register
ENABLE_ABUSEIPDB=true
ABUSEIPDB_API_KEY=
ABUSEIPDB_RATE_LIMIT=1000
CACHE_ABUSEIPDB_TTL=86400

# --------------------------------------------
# Shodan (Optional - Basic tier 1 req/sec)
# --------------------------------------------
# Get your key: https://account.shodan.io/
ENABLE_SHODAN=false
SHODAN_API_KEY=
SHODAN_RATE_LIMIT=1

# --------------------------------------------
# MaxMind GeoLite2 (Optional - Free offline DB)
# --------------------------------------------
# Get your key: https://www.maxmind.com/en/geolite2/signup
ENABLE_MAXMIND=false
MAXMIND_LICENSE_KEY=
MAXMIND_ACCOUNT_ID=

# --------------------------------------------
# IP-API (Fallback - No key needed)
# --------------------------------------------
# Free: 45/min, 1000/day
ENABLE_IPAPI=true

# ============================================
# Caching Configuration
# ============================================

# Cache TTLs in seconds
CACHE_GEOIP_TTL=604800
CACHE_SHODAN_TTL=2592000

# Cache directory
CACHE_DIR=./cache

# ============================================
# Shell Emulation Settings
# ============================================

# Emulation profile: raspberry-pi, ubuntu-server, generic-iot, debian-server
EMULATION_PROFILE=raspberry-pi

# Generate dynamic filesystem content
FILESYSTEM_DYNAMIC=true

# Respond to VM detection attempts
VM_DETECTION_EVASION=true

# Simulate command execution delays (milliseconds)
COMMAND_DELAY_MS=50

# Show fake processes in ps aux
SHOW_FAKE_PROCESSES=true

# ============================================
# Session Management
# ============================================

# Maximum concurrent SSH sessions
MAX_CONCURRENT_SESSIONS=50

# Session timeout in seconds (idle disconnect)
SESSION_TIMEOUT=300

# Maximum commands per session before auto-disconnect
MAX_COMMANDS_PER_SESSION=100

# ============================================
# Security Settings
# ============================================

# Rate limiting: max connections per IP per minute
RATE_LIMIT_CONNECTIONS=10
RATE_LIMIT_WINDOW_MS=60000

# Ban IP after X failed rapid connections
BAN_AFTER_CONNECTIONS=20
BAN_DURATION_MS=3600000

# Enable connection logging for localhost (dev/testing)
LOG_LOCALHOST=false

# ============================================
# Advanced Settings
# ============================================

# Node environment
NODE_ENV=production

# Enable debug mode
DEBUG=false

# Malware download directory
MALWARE_DIR=./logs/malware

# Enable malware capture (wget/curl downloads)
ENABLE_MALWARE_CAPTURE=true

# Maximum malware file size (bytes) - 10MB default
MAX_MALWARE_SIZE=10485760

# ============================================
# Docker-Specific Settings (when using Docker)
# ============================================

# Container timezone
TZ=UTC

# User/Group ID for log file permissions
PUID=1001
PGID=1001
